#Template Version 1.0.0

name: Publish to Artifactory

on:
  release:
    types: [published,edited]

jobs:
  test:
    runs-on: ubuntu-latest
    env:
        GIT_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
    name: A job to test this action
    steps:    
    - uses: actions/checkout@v2
    - name: Set output
      id: vars
      run: echo ::set-output name=tag::${GITHUB_REF#refs/*/}
      
    - uses: dsaltares/fetch-gh-release-asset@master
      with:
        repo: "${{ github.repository }}"
        file: "${{ steps.vars.outputs.tag }}"
        target: "release-asset.zip"
        token: ${{ secrets.GITHUB_TOKEN }} 
    
    - name: Display download directory
      run: | 
          ls -R
          
    - name: publish to artifactory
      uses: advancedcsg-open/action-jfrog-cli@master
      with:
        url: 'https://itsme.jfrog.io/'
        credentials type: 'username'
        user: 'tilakkalyan@gmail.com'
        password: 'Itsme148!'
        args: u "release-asset.zip" "/artifactory/default-maven-virtual/" 

